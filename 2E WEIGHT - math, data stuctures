#include<bits/stdc++.h>
#define ll long long
using namespace std;

int const A = 1e6+1;
int n, a[A], l[A], r[A], st[A], top = 0;
void push(int x){top++; st[top] = x;}
void pop(){top--;}
void clear(){top = 0;}
ll sumx = 0, sumn = 0, res = 0;

main()
{
	ios::sync_with_stdio(0); cin.tie(0);
	cin >> n;
	
	for(int i = 1; i <= n; i++) cin >> a[i];
	
	//max
	clear();
	for(int i = 1; i <= n; i++)
	{
		while(top > 0 && a[i] > a[st[top]]) pop();
		if(top > 0) l[i] = st[top]+1;
		else l[i] = 1;
		push(i);
//		cout << l[i] << ' ';
	}
//	cout << '\n';
	
	clear();
	for(int i = n; i >= 1; i--)
	{
		while(top > 0 && a[i] >= a[st[top]]) pop();
		if(top > 0) r[i] = st[top] - 1;
		else r[i] = n;
		push(i);
//		cout << r[i] << ' ';
	}
//	cout << '\n';
	
	for(int i = 1; i <= n; i++)
		sumx = sumx + (i - l[i] + 1) * 1ll * (r[i] - i + 1) * a[i];
	
	//min
	clear();
	for(int i = 1; i <= n; i++)
	{
		while(top > 0 && a[i] < a[st[top]]) pop();
		if(top > 0) l[i] = st[top]+1;
		else l[i] = 1;
		push(i);
//		cout << l[i] << ' ';
	}
//	cout << '\n';

	clear();
	for(int i = n; i >= 1; i--)
	{
		while(top > 0 && a[i] <= a[st[top]]) pop();
		if(top > 0) r[i] = st[top] - 1;
		else r[i] = n;
		push(i);
//		cout << r[i] << ' ';
	}
//	cout << '\n';

	for(int i = 1; i <= n; i++)
		sumn = sumn + (i - l[i] + 1) * 1ll * (r[i] - i + 1) * a[i];
	
	cout << sumx - sumn;
}
